# DSE v2 Third Party í™•ì¥ ì‹œìŠ¤í…œ ì‚¬ìš© ê°€ì´ë“œ

DSE v2ì—ì„œ ì œê³µí•˜ëŠ” Third Party í™•ì¥ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ `Project`, `DsSystem` ë“±ì˜ í•µì‹¬ íƒ€ì…ì„ í™•ì¥í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ¯ í™•ì¥ ì‹œìŠ¤í…œ ê°œìš”

DSE v2ëŠ” ì™„ì „í•œ Third Party í™•ì¥ ì‹œìŠ¤í…œì„ ì œê³µí•˜ì—¬ ë‹¤ìŒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤:

- **í•µì‹¬ íƒ€ì… í™•ì¥**: Project, DsSystem, Work, Call ë“± í•µì‹¬ ë„ë©”ì¸ ê°ì²´ í™•ì¥
- **Complete Type Support**: Runtime + JSON + ORM ëª¨ë“  ê³„ì¸µì—ì„œ í™•ì¥ ì§€ì›
- **Factory Integration**: ëª¨ë“  ê°ì²´ ìƒì„± ê²½ë¡œì—ì„œ í™•ì¥ íƒ€ì… ìë™ ì‚¬ìš©
- **100% í˜¸í™˜ì„±**: ê¸°ì¡´ ì½”ë“œ ë³€ê²½ ì—†ì´ í™•ì¥ ì‹œìŠ¤í…œ ì ìš©

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
YourExtensionProject/
â”œâ”€â”€ YourExtensionProject.csproj
â”œâ”€â”€ ExtensionBootstrapper.cs        # í™•ì¥ ì´ˆê¸°í™”
â”œâ”€â”€ ExtensibleTypeFactory.cs        # í™•ì¥ íŒ©í† ë¦¬ êµ¬í˜„
â”œâ”€â”€ Extensions/
â”‚   â”œâ”€â”€ CustomProject.cs            # Project í™•ì¥
â”‚   â”œâ”€â”€ CustomNjProject.cs          # JSON í™•ì¥
â”‚   â”œâ”€â”€ CustomORMProject.cs         # ORM í™•ì¥
â”‚   â”œâ”€â”€ CustomSystem.cs             # DsSystem í™•ì¥
â”‚   â”œâ”€â”€ CustomNjSystem.cs           # JSON í™•ì¥
â”‚   â””â”€â”€ CustomORMSystem.cs          # ORM í™•ì¥
â””â”€â”€ Program.cs                       # ì‚¬ìš© ì˜ˆì‹œ
```

### 2. ì˜ì¡´ì„± ì¶”ê°€

```xml
<!-- YourExtensionProject.csproj -->
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <LangVersion>12.0</LangVersion>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="path/to/Ev2.Core.FS/Ev2.Core.FS.fsproj" />
    <PackageReference Include="Newtonsoft.Json" Version="13.0.3" />
  </ItemGroup>
</Project>
```

## ğŸ“‹ ë‹¨ê³„ë³„ êµ¬í˜„ ê°€ì´ë“œ

### Step 1: í™•ì¥ íƒ€ì… ì •ì˜

#### Runtime í™•ì¥ íƒ€ì… (CustomProject.cs)
```csharp
using System;
using System.Collections.Generic;
// DsObjectModule ì œê±°ë¨ - íƒ€ì…ë“¤ì´ namespace ìµœìƒìœ„ë¡œ ì´ë™
// Project, DsSystem ë“±ì„ ì§ì ‘ Ev2.Core.FSì—ì„œ ì ‘ê·¼

namespace YourExtension.Extensions
{
    public class CustomProject : Project
    {
        public int Priority { get; set; } = 0;
        public string Category { get; set; } = string.Empty;
        public List<string> Tags { get; set; } = new List<string>();

        public CustomProject() : base(new List<DsSystem>(), new List<DsSystem>())
        {
        }

        public void AddTag(string tag)
        {
            if (!Tags.Contains(tag))
                Tags.Add(tag);
        }

        public string GetSummary()
        {
            return $"{Name} (Priority: {Priority}, Category: {Category})";
        }
    }

    public class CustomSystem : DsSystem
    {
        public int ComplexityLevel { get; set; } = 0;
        public string ResponsiblePerson { get; set; } = string.Empty;
        public SystemStatus Status { get; set; } = SystemStatus.Planning;
        private Dictionary<string, object> _metadata = new();

        public CustomSystem() : base(new Flow[0], new Work[0], 
            new ArrowBetweenWorks[0], new ApiDef[0], new ApiCall[0])
        {
        }

        public void SetMetadata(string key, object value)
        {
            _metadata[key] = value;
        }

        public T GetMetadata<T>(string key)
        {
            return _metadata.TryGetValue(key, out var value) ? (T)value : default(T);
        }
    }

    public enum SystemStatus
    {
        Planning,
        Development,
        Testing,
        Production,
        Deprecated
    }
}
```

#### JSON í™•ì¥ íƒ€ì… (CustomNjProject.cs)
```csharp
using Ev2.Core.FS.NewtonsoftJsonObjects;
using System.Collections.Generic;

namespace YourExtension.Extensions
{
    public class CustomNjProject : NjProject
    {
        public int Priority { get; set; } = 0;
        public string Category { get; set; } = string.Empty;
        public List<string> Tags { get; set; } = new List<string>();

        public CustomNjProject() { }

        public CustomNjProject(CustomProject runtime)
        {
            // Runtime ê°ì²´ì—ì„œ JSON ê°ì²´ë¡œ ë³€í™˜
            Name = runtime.Name;
            Description = runtime.Description;
            Priority = runtime.Priority;
            Category = runtime.Category;
            Tags = new List<string>(runtime.Tags);
            // ê¸°íƒ€ ê¸°ë³¸ ì†ì„±ë“¤ ë³µì‚¬...
        }
    }

    public class CustomNjSystem : NjSystem
    {
        public int ComplexityLevel { get; set; } = 0;
        public string ResponsiblePerson { get; set; } = string.Empty;
        public string Status { get; set; } = "Planning";
        public Dictionary<string, object> Metadata { get; set; } = new();

        public CustomNjSystem() { }

        public CustomNjSystem(CustomSystem runtime)
        {
            Name = runtime.Name;
            Description = runtime.Description;
            ComplexityLevel = runtime.ComplexityLevel;
            ResponsiblePerson = runtime.ResponsiblePerson;
            Status = runtime.Status.ToString();
            Metadata = new Dictionary<string, object>();
            // ë©”íƒ€ë°ì´í„° ë³µì‚¬ ë¡œì§ í•„ìš”...
        }
    }
}
```

#### ORM í™•ì¥ íƒ€ì… (CustomORMProject.cs)
```csharp
using static Ev2.Core.FS.ORMTypesModule;
using Newtonsoft.Json;

namespace YourExtension.Extensions
{
    public class CustomORMProject : ORMProject
    {
        public int Priority { get; set; } = 0;
        public string Category { get; set; } = string.Empty;
        public string Tags { get; set; } = string.Empty; // JSON ì§ë ¬í™”í•˜ì—¬ ì €ì¥

        public CustomORMProject() { }

        public CustomORMProject(CustomProject runtime)
        {
            Name = runtime.Name;
            Description = runtime.Description;
            Priority = runtime.Priority;
            Category = runtime.Category;
            Tags = JsonConvert.SerializeObject(runtime.Tags);
            // ê¸°íƒ€ ORM ì†ì„±ë“¤...
        }
    }

    public class CustomORMSystem : ORMSystem
    {
        public int ComplexityLevel { get; set; } = 0;
        public string ResponsiblePerson { get; set; } = string.Empty;
        public string Status { get; set; } = "Planning";
        public string Metadata { get; set; } = "{}";

        public CustomORMSystem() { }

        public CustomORMSystem(CustomSystem runtime)
        {
            Name = runtime.Name;
            Description = runtime.Description;
            ComplexityLevel = runtime.ComplexityLevel;
            ResponsiblePerson = runtime.ResponsiblePerson;
            Status = runtime.Status.ToString();
            // ë©”íƒ€ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ì§ë ¬í™”í•˜ì—¬ ì €ì¥...
        }
    }
}
```

### Step 2: ExtensibleTypeFactory êµ¬í˜„

```csharp
using System;
using System.Collections.Generic;
using Ev2.Core.FS;

namespace YourExtension
{
    public class ExtensibleTypeFactory : ITypeFactory
    {
        private readonly Dictionary<Type, Func<object>> _runtimeFactories = new();
        private readonly Dictionary<Type, Type> _jsonTypeMap = new();
        private readonly Dictionary<Type, Type> _ormTypeMap = new();
        private readonly Dictionary<Type, Func<object, object>> _jsonFactories = new();
        private readonly Dictionary<Type, Func<object>> _ormFactories = new();

        public void RegisterExtensionForBaseType<TBase, TExtRuntime, TExtJson, TExtOrm>()
            where TBase : class
            where TExtRuntime : class, TBase, new()
            where TExtJson : class
            where TExtOrm : class, new()
        {
            var baseType = typeof(TBase);
            var extRuntimeType = typeof(TExtRuntime);
            var extJsonType = typeof(TExtJson);
            var extOrmType = typeof(TExtOrm);

            // ê¸°ë³¸ íƒ€ì…ì„ í‚¤ë¡œ í•´ì„œ í™•ì¥ íƒ€ì… ìƒì„±ì ë“±ë¡
            _runtimeFactories[baseType] = () => new TExtRuntime();
            _jsonTypeMap[baseType] = extJsonType;
            _ormTypeMap[baseType] = extOrmType;

            // JSON ìƒì„±ì ë“±ë¡
            _jsonFactories[baseType] = (runtimeObj) =>
            {
                try
                {
                    return Activator.CreateInstance(extJsonType, runtimeObj);
                }
                catch
                {
                    return Activator.CreateInstance(extJsonType);
                }
            };

            // ORM ìƒì„±ì ë“±ë¡
            _ormFactories[baseType] = () => new TExtOrm();
        }

        public object CreateRuntime(Type runtimeType)
        {
            return _runtimeFactories.TryGetValue(runtimeType, out var factory)
                ? factory() : null;
        }

        public object CreateJson(Type runtimeType, object runtimeObj)
        {
            return _jsonFactories.TryGetValue(runtimeType, out var factory)
                ? factory(runtimeObj) : null;
        }

        public object CreateOrm(Type runtimeType)
        {
            return _ormFactories.TryGetValue(runtimeType, out var factory)
                ? factory() : null;
        }

        public Type GetJsonType(Type runtimeType)
        {
            return _jsonTypeMap.TryGetValue(runtimeType, out var jsonType)
                ? jsonType : null;
        }

        public Type GetOrmType(Type runtimeType)
        {
            return _ormTypeMap.TryGetValue(runtimeType, out var ormType)
                ? ormType : null;
        }

        public string GetRegisteredTypesInfo()
        {
            var info = $"Registered Types ({_runtimeFactories.Count}):\n";
            foreach (var kvp in _runtimeFactories)
            {
                var runtimeType = kvp.Key.Name;
                var jsonType = _jsonTypeMap.TryGetValue(kvp.Key, out var jType) ? jType.Name : "N/A";
                var ormType = _ormTypeMap.TryGetValue(kvp.Key, out var oType) ? oType.Name : "N/A";
                info += $"  {runtimeType} â†’ JSON: {jsonType}, ORM: {ormType}\n";
            }
            return info;
        }
    }
}
```

### Step 3: ExtensionBootstrapper êµ¬í˜„

```csharp
using System;
using Ev2.Core.FS;
using YourExtension.Extensions;

namespace YourExtension
{
    public static class ExtensionBootstrapper
    {
        private static ExtensibleTypeFactory _factory;
        private static bool _isInitialized = false;

        public static void Initialize()
        {
            if (_isInitialized)
            {
                Console.WriteLine("ExtensionBootstrapper already initialized.");
                return;
            }

            _factory = new ExtensibleTypeFactory();

            // Third Party í™•ì¥ íƒ€ì…ë“¤ ë“±ë¡
            RegisterExtensionTypes(_factory);

            // F# Coreì— factory ì£¼ì…
            TypeFactoryModule.TypeFactory = Microsoft.FSharp.Core.FSharpOption<ITypeFactory>.Some(_factory);

            _isInitialized = true;

            Console.WriteLine("ExtensionBootstrapper initialized successfully.");
            Console.WriteLine(_factory.GetRegisteredTypesInfo());
        }

        private static void RegisterExtensionTypes(ExtensibleTypeFactory factory)
        {
            try
            {
                // ê¸°ë³¸ íƒ€ì…ì„ í‚¤ë¡œ í•´ì„œ í™•ì¥ íƒ€ì…ë“¤ì„ ë“±ë¡
                factory.RegisterExtensionForBaseType<Ev2.Core.FS.Project, 
                    CustomProject, CustomNjProject, CustomORMProject>();
                Console.WriteLine("  âœ“ CustomProject extension registered for base Project type");

                factory.RegisterExtensionForBaseType<Ev2.Core.FS.DsSystem, 
                    CustomSystem, CustomNjSystem, CustomORMSystem>();
                Console.WriteLine("  âœ“ CustomSystem extension registered for base DsSystem type");

                Console.WriteLine("Extension types registered successfully.");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Warning: Error registering extension types: {ex.Message}");
                Console.WriteLine($"Stack trace: {ex.StackTrace}");
            }
        }

        public static string GetRegisteredTypesInfo()
        {
            if (!_isInitialized)
            {
                return "ExtensionBootstrapper not initialized.";
            }
            return _factory.GetRegisteredTypesInfo();
        }

        public static bool IsInitialized => _isInitialized;
    }
}
```

### Step 4: í™•ì¥ ì‹œìŠ¤í…œ ì‚¬ìš©

```csharp
using System;
using Ev2.Core.FS;
using YourExtension;

namespace YourExtension
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("=== Third Party Extension Demo ===");
            Console.WriteLine();

            try
            {
                // 1. í™•ì¥ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
                var appInitResult = Ev2.Core.FS.DsObjectFactory.InitializeAppSettings();
                Console.WriteLine($"âœ“ {appInitResult}");

                ExtensionBootstrapper.Initialize();
                Console.WriteLine();

                // 2. Factoryë¥¼ í†µí•œ í™•ì¥ íƒ€ì… ìƒì„± í…ŒìŠ¤íŠ¸
                TestFactoryBasedExtensions();

                // 3. F# ëª¨ë“ˆ í•¨ìˆ˜ë¥¼ í†µí•œ í™•ì¥ íƒ€ì… ìƒì„± í…ŒìŠ¤íŠ¸
                TestFSharpModuleFunctions();

                // 4. ì§ì ‘ í™•ì¥ íƒ€ì… ìƒì„± í…ŒìŠ¤íŠ¸
                TestDirectExtensionTypes();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error: {ex.Message}");
                Console.WriteLine($"Stack trace: {ex.StackTrace}");
            }

            Console.WriteLine("\nPress any key to exit...");
            Console.ReadKey();
        }

        private static void TestFactoryBasedExtensions()
        {
            Console.WriteLine("=== Factory-Based Extension Test ===");

            // DsObjectFactoryë¥¼ í†µí•´ ê°ì²´ ìƒì„± - ë“±ë¡ëœ í™•ì¥ íƒ€ì…ì´ ìƒì„±ë¨
            var project = Ev2.Core.FS.DsObjectFactory.CreateProject();
            var system = Ev2.Core.FS.DsObjectFactory.CreateDsSystem();

            Console.WriteLine($"Factory Project type: {project.GetType().FullName}");
            Console.WriteLine($"Factory System type: {system.GetType().FullName}");

            // í™•ì¥ íƒ€ì… ì—¬ë¶€ í™•ì¸
            bool isCustomProject = project is YourExtension.Extensions.CustomProject;
            bool isCustomSystem = system is YourExtension.Extensions.CustomSystem;

            Console.WriteLine($"Is CustomProject: {isCustomProject}");
            Console.WriteLine($"Is CustomSystem: {isCustomSystem}");

            if (isCustomProject)
            {
                var customProject = project as YourExtension.Extensions.CustomProject;
                customProject.Name = "Factory Test Project";
                customProject.Priority = 10;
                customProject.Category = "Testing";
                customProject.AddTag("Factory");
                customProject.AddTag("Test");

                Console.WriteLine($"Project Summary: {customProject.GetSummary()}");
            }

            Console.WriteLine();
        }

        private static void TestFSharpModuleFunctions()
        {
            Console.WriteLine("=== F# Module Function Test ===");

            // F# ëª¨ë“ˆ í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì„œë„ í™•ì¥ íƒ€ì…ì´ ìƒì„±ë¨
            var project = Ev2.Core.FS.DsObjectCreate.createProject();
            var system = Ev2.Core.FS.DsObjectCreate.createDsSystem();

            Console.WriteLine($"Module Project type: {project.GetType().FullName}");
            Console.WriteLine($"Module System type: {system.GetType().FullName}");

            bool isCustomProject = project is YourExtension.Extensions.CustomProject;
            bool isCustomSystem = system is YourExtension.Extensions.CustomSystem;

            Console.WriteLine($"Is CustomProject: {isCustomProject}");
            Console.WriteLine($"Is CustomSystem: {isCustomSystem}");

            Console.WriteLine();
        }

        private static void TestDirectExtensionTypes()
        {
            Console.WriteLine("=== Direct Extension Type Test ===");

            // ì§ì ‘ í™•ì¥ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
            var customProject = new YourExtension.Extensions.CustomProject();
            customProject.Name = "Direct Test Project";
            customProject.Priority = 20;
            customProject.Category = "Direct";
            customProject.AddTag("Direct");
            customProject.AddTag("Test");

            var customSystem = new YourExtension.Extensions.CustomSystem();
            customSystem.Name = "Direct Test System";
            customSystem.ComplexityLevel = 5;
            customSystem.ResponsiblePerson = "Developer";
            customSystem.Status = YourExtension.Extensions.SystemStatus.Development;
            customSystem.SetMetadata("Version", "1.0.0");
            customSystem.SetMetadata("CreationDate", DateTime.Now);

            Console.WriteLine($"Direct Project Summary: {customProject.GetSummary()}");
            Console.WriteLine($"Direct System Complexity: {customSystem.ComplexityLevel}");
            Console.WriteLine($"Direct System Version: {customSystem.GetMetadata<string>("Version")}");

            Console.WriteLine();
        }
    }
}
```

## ğŸ”§ ê³ ê¸‰ ì‚¬ìš©ë²•

### í™•ì¥ íƒ€ì… ë™ì  ë“±ë¡

```csharp
// ëŸ°íƒ€ì„ì— ì¶”ê°€ í™•ì¥ íƒ€ì… ë“±ë¡
ExtensionBootstrapper.RegisterExtensionType<CustomWork, CustomNjWork, CustomORMWork>();
```

### íƒ€ì… ë³€í™˜ (Runtime â†” JSON â†” ORM)

```csharp
// Runtime â†’ JSON ë³€í™˜
var runtimeProject = Ev2.Core.FS.DsObjectFactory.CreateProject() as CustomProject;
var jsonProject = new CustomNjProject(runtimeProject);

// Runtime â†’ ORM ë³€í™˜  
var ormProject = new CustomORMProject(runtimeProject);

// JSON ì§ë ¬í™”
var jsonString = Newtonsoft.Json.JsonConvert.SerializeObject(jsonProject, 
    Newtonsoft.Json.Formatting.Indented);
```

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™

```csharp
// í™•ì¥ DB ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
public class ExtensionDbHandler : IExtensionDbHandler
{
    public void HandleAfterInsert(object obj, IDbConnection conn, IDbTransaction trans)
    {
        if (obj is CustomProject project)
        {
            // í™•ì¥ ì†ì„±ì„ ë³„ë„ í…Œì´ë¸”ì— ì €ì¥
            SaveProjectExtensions(project, conn, trans);
        }
    }

    public void HandleAfterUpdate(object obj, IDbConnection conn, IDbTransaction trans)
    {
        // ì—…ë°ì´íŠ¸ ì²˜ë¦¬...
    }

    public void HandleAfterDelete(object obj, IDbConnection conn, IDbTransaction trans)
    {
        // ì‚­ì œ ì²˜ë¦¬...
    }

    public object HandleAfterSelect(object baseObj, IDbConnection conn, IDbTransaction trans)
    {
        // Select í›„ í™•ì¥ ì†ì„± ë³µì›...
        return baseObj;
    }

    private void SaveProjectExtensions(CustomProject project, IDbConnection conn, IDbTransaction trans)
    {
        // í™•ì¥ ì†ì„±ì„ DBì— ì €ì¥í•˜ëŠ” ë¡œì§
    }
}

// í™•ì¥ DB í•¸ë“¤ëŸ¬ ë“±ë¡
var dbHandler = new ExtensionDbHandler();
TypeFactoryModule.ExtensionDbHandler = Microsoft.FSharp.Core.FSharpOption<IExtensionDbHandler>.Some(dbHandler);
```

## âœ… ëª¨ë²” ì‚¬ë¡€

### 1. ë„¤ì´ë° ê·œì¹™
- Runtime íƒ€ì…: `CustomProject`, `CustomSystem`
- JSON íƒ€ì…: `CustomNjProject`, `CustomNjSystem`  
- ORM íƒ€ì…: `CustomORMProject`, `CustomORMSystem`

### 2. ì´ˆê¸°í™” ìˆœì„œ
```csharp
// ì˜¬ë°”ë¥¸ ì´ˆê¸°í™” ìˆœì„œ
Ev2.Core.FS.DsObjectFactory.InitializeAppSettings();  // 1. F# Core ì´ˆê¸°í™”
ExtensionBootstrapper.Initialize();                   // 2. í™•ì¥ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
// 3. ì´í›„ ëª¨ë“  ê°ì²´ ìƒì„±ì—ì„œ í™•ì¥ íƒ€ì… ìë™ ì‚¬ìš©
```

### 3. íƒ€ì… ë³€í™˜ ìµœì í™”
```csharp
public class CustomNjProject : NjProject
{
    public CustomNjProject(CustomProject runtime)
    {
        // ê¸°ë³¸ ì†ì„± ìë™ ë³µì‚¬
        this.CopyBasicPropertiesFrom(runtime);
        
        // í™•ì¥ ì†ì„±ë§Œ ë³„ë„ ì²˜ë¦¬
        this.Priority = runtime.Priority;
        this.Category = runtime.Category;
        this.Tags = new List<string>(runtime.Tags);
    }
}
```

### 4. ì˜¤ë¥˜ ì²˜ë¦¬
```csharp
public static void Initialize()
{
    try 
    {
        // í™•ì¥ ì‹œìŠ¤í…œ ì´ˆê¸°í™”...
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Extension initialization failed: {ex.Message}");
        // Fallback ì „ëµ: ê¸°ë³¸ íƒ€ì…ìœ¼ë¡œ ë™ì‘
        throw; // ë˜ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ê³„ì† ì§„í–‰
    }
}
```

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### 1. ì˜ì¡´ì„± ê´€ë¦¬
- Ev2.Core.FS í”„ë¡œì íŠ¸ë¥¼ ì°¸ì¡°í•´ì•¼ í•¨
- Newtonsoft.Json íŒ¨í‚¤ì§€ í•„ìš”
- .NET 9.0 ì´ìƒ ê¶Œì¥

### 2. ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
- í™•ì¥ íƒ€ì… ìƒì„±ì€ ì•½ê°„ì˜ ì˜¤ë²„í—¤ë“œê°€ ìˆìŒ
- ëŒ€ëŸ‰ ê°ì²´ ìƒì„± ì‹œ í”„ë¡œíŒŒì¼ë§ ê¶Œì¥
- ìºì‹± ì „ëµ ê³ ë ¤

### 3. í˜¸í™˜ì„±
- ê¸°ì¡´ ì½”ë“œëŠ” ìˆ˜ì • ì—†ì´ ë™ì‘í•¨
- í™•ì¥ ì‹œìŠ¤í…œì´ ë¹„í™œì„±í™”ë˜ë©´ ê¸°ë³¸ íƒ€ì…ìœ¼ë¡œ Fallback
- ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ì‹œ ì¸í„°í˜ì´ìŠ¤ í˜¸í™˜ì„± í™•ì¸ í•„ìš”

### 4. í…ŒìŠ¤íŠ¸
- í™•ì¥ íƒ€ì…ê³¼ ê¸°ë³¸ íƒ€ì… ëª¨ë‘ í…ŒìŠ¤íŠ¸
- JSON ì§ë ¬í™”/ì—­ì§ë ¬í™” í…ŒìŠ¤íŠ¸
- ë°ì´í„°ë² ì´ìŠ¤ CRUD í…ŒìŠ¤íŠ¸

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì¶”ê°€ ê¸°ëŠ¥ì´ í•„ìš”í•œ ê²½ìš°:
1. ì´ ë¬¸ì„œì˜ ì˜ˆì‹œ ì½”ë“œ í™•ì¸
2. `Hmc.Aas` í”„ë¡œì íŠ¸ì˜ êµ¬í˜„ ì°¸ì¡°
3. F# Core ì½”ë“œì—ì„œ `createExtensible` í•¨ìˆ˜ ë™ì‘ í™•ì¸
4. GitHub Issues ë˜ëŠ” ê°œë°œíŒ€ì— ë¬¸ì˜

---

## ğŸ†• ìƒˆë¡œìš´ createExtended<T>() íŒ¨í„´ (v1.4)

### ê°œìš”

DSE v2ì— ìƒˆë¡œìš´ ê°ì²´ ìƒì„± íŒ¨í„´ì¸ `createExtended<T>()`ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ íŒ¨í„´ì€ ì„œë¸Œí´ë˜ìŠ¤(í™•ì¥ íƒ€ì…)ì—ì„œ ê¸°ë³¸ ìƒì„±ìë¡œ ê°ì²´ë¥¼ ìƒì„±í•œ í›„, `Initialize` ë©”ì„œë“œë¡œ ì´ˆê¸°í™”í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

### ê¸°ë³¸ ì‚¬ìš©ë²•

```fsharp
// ìƒˆë¡œìš´ íŒ¨í„´: ì œë„¤ë¦­ íƒ€ì…ìœ¼ë¡œ ì§ì ‘ ìƒì„±
let extended = createExtended<DsSystem>()    // DsSystem subclass object ìƒì„±
extended.Initialize(flows, works, arrows, apiDefs, apiCalls) |> tee (fun system ->
    // ì¶”ê°€ ì´ˆê¸°í™” ë¡œì§
    system.UpdateDateTime()
    printfn "System initialized: %s" system.Name
)
```

### Factory ë©”ì„œë“œ ì‚¬ìš©

```fsharp
// Factoryë¥¼ í†µí•œ ì‚¬ìš©
let system = DsObjectFactory.CreateDsSystemExtended()
system.Initialize(flows, works, arrows, apiDefs, apiCalls) |> ignore

let work = DsObjectFactory.CreateWorkExtended() 
work.Initialize(calls, arrows, flow) |> ignore

let call = DsObjectFactory.CreateCallExtended()
call.Initialize(callType, apiCalls, autoConditions, commonConditions, isDisabled, timeout) |> ignore
```

### C#ì—ì„œì˜ ì‚¬ìš©

```csharp
// C#ì—ì„œ ìƒˆë¡œìš´ íŒ¨í„´ ì‚¬ìš©
var system = DsObjectFactory.CreateDsSystemExtended();
system.Initialize(flows, works, arrows, apiDefs, apiCalls);

// ë˜ëŠ” ì§ì ‘ í˜¸ì¶œ
var extended = TypeFactoryHelper.createExtended<DsSystem>();
extended.Initialize(flows, works, arrows, apiDefs, apiCalls);
```

### ì²´ì´ë‹ íŒ¨í„´

```fsharp
// ë©”ì„œë“œ ì²´ì´ë‹ìœ¼ë¡œ ì‚¬ìš©
let result = 
    createExtended<DsSystem>()
    |> fun s -> s.Initialize(flows, works, arrows, apiDefs, apiCalls)
    |> tee (fun system -> 
        system.Name <- "My System"
        system.UpdateDateTime()
    )
    |> tee (fun system -> printfn "Created: %s" system.GetFQDN())
```

### ì§€ì›ë˜ëŠ” íƒ€ì…

ëª¨ë“  ì£¼ìš” DSE íƒ€ì…ì—ì„œ ìƒˆë¡œìš´ íŒ¨í„´ì„ ì§€ì›í•©ë‹ˆë‹¤:

- `Project()`
- `DsSystem()`  
- `Work()`
- `Call()`
- `Flow()`
- `ApiDef()`
- `ApiCall()`

### Initialize ë©”ì„œë“œ

ê° íƒ€ì…ì—ëŠ” í•´ë‹¹í•˜ëŠ” Initialize í™•ì¥ ë©”ì„œë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤:

```fsharp
// DsSystem.Initialize
member x.Initialize(flows:Flow[], works:Work[], arrows:ArrowBetweenWorks[], 
                   apiDefs:ApiDef[], apiCalls:ApiCall[]) = 
    // ê¸°ì¡´ ì»¬ë ‰ì…˜ ì´ˆê¸°í™” í›„ ìƒˆë¡œìš´ ë°ì´í„° ì„¤ì •
    x

// Work.Initialize  
member x.Initialize(calls:Call seq, arrows:ArrowBetweenCalls seq, flow:Flow option) =
    // ê¸°ì¡´ ì»¬ë ‰ì…˜ ì´ˆê¸°í™” í›„ ìƒˆë¡œìš´ ë°ì´í„° ì„¤ì •
    x

// Call.Initialize
member x.Initialize(callType:DbCallType, apiCalls:ApiCall seq,
                   autoConditions:string seq, commonConditions:string seq, 
                   isDisabled:bool, timeout:int option) =
    // ê¸°ì¡´ ë°ì´í„° ì´ˆê¸°í™” í›„ ìƒˆë¡œìš´ ë°ì´í„° ì„¤ì •
    x
```

### í™•ì¥ ì‹œìŠ¤í…œê³¼ì˜ í†µí•©

ìƒˆë¡œìš´ `createExtended<T>()` íŒ¨í„´ì€ ê¸°ì¡´ í™•ì¥ ì‹œìŠ¤í…œê³¼ ì™„ë²½í•˜ê²Œ í†µí•©ë©ë‹ˆë‹¤:

```csharp
public class CustomSystem : DsSystem
{
    public int ComplexityLevel { get; set; } = 0;
    
    // ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜
    public CustomSystem() : base()
    {
        // í™•ì¥ ì†ì„± ì´ˆê¸°í™”
    }
}

// ì‚¬ìš© ì‹œ
var customSystem = createExtended<DsSystem>();  // CustomSystem ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë¨
customSystem.Initialize(flows, works, arrows, apiDefs, apiCalls);
```

### ê¸°ì¡´ íŒ¨í„´ê³¼ì˜ í˜¸í™˜ì„±

ê¸°ì¡´ `createExtensible` íŒ¨í„´ë„ ê³„ì† ì§€ì›ë˜ë¯€ë¡œ í˜¸í™˜ì„±ì— ë¬¸ì œì—†ìŠµë‹ˆë‹¤:

```fsharp
// ê¸°ì¡´ íŒ¨í„´ (ê³„ì† ì§€ì›)
let oldStyle = createExtensible (fun () -> DsSystem([||], [||], [||], [||], [||]))

// ìƒˆë¡œìš´ íŒ¨í„´
let newStyle = createExtended<DsSystem>()
newStyle.Initialize([||], [||], [||], [||], [||]) |> ignore
```

### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### TypeFactory.fsì˜ ë³€ê²½ì‚¬í•­

```fsharp
/// ê¸°ì¡´ ë²„ì „ - ëŒë‹¤ ë²„ì „ (í˜¸í™˜ì„± ìœ ì§€)
let inline createExtensible<'T> (defaultFactory: unit -> 'T) =
    match TypeFactory with
    | Some factory ->
        let obj = factory.CreateRuntime(typeof<'T>)
        if obj <> null then obj :?> 'T else defaultFactory()
    | None -> defaultFactory()

/// ìƒˆë¡œìš´ ì œë„¤ë¦­ ë²„ì „ - ë§¤ê°œë³€ìˆ˜ ì—†ëŠ” ì§ì ‘ ìƒì„±
let inline createExtended<'T when 'T : (new : unit -> 'T) and 'T :> Unique>() : 'T =
    match TypeFactory with
    | Some factory ->
        let obj = factory.CreateRuntime(typeof<'T>)
        if obj <> null then obj :?> 'T else new 'T()
    | None -> new 'T()
```

#### ê¸°ë³¸ ìƒì„±ì ì¶”ê°€

ëª¨ë“  í•µì‹¬ íƒ€ì…ì— ë§¤ê°œë³€ìˆ˜ ì—†ëŠ” ê¸°ë³¸ ìƒì„±ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤:

```fsharp
type DsSystem(...) =
    // ê¸°ì¡´ ë§¤ê°œë³€ìˆ˜ ìƒì„±ì
    inherit ProjectEntity()
    
    // ìƒˆë¡œìš´ ê¸°ë³¸ ìƒì„±ì
    new() = DsSystem(Seq.empty, Seq.empty, Seq.empty, Seq.empty, Seq.empty)

type Work(...) = 
    inherit DsSystemEntity()
    
    new() = Work(Seq.empty, Seq.empty, None)

type Call(...) =
    inherit WorkEntity()
    
    new() = Call(DbCallType.Normal, Seq.empty, Seq.empty, Seq.empty, false, None)
```

### ì¥ì 

1. **íƒ€ì… ì•ˆì „ì„±**: ì œë„¤ë¦­ íƒ€ì…ìœ¼ë¡œ ì»´íŒŒì¼ íƒ€ì„ì— íƒ€ì… ê²€ì‚¬
2. **ê°„ê²°ì„±**: ëŒë‹¤ í•¨ìˆ˜ ì—†ì´ ì§ì ‘ íƒ€ì… ì§€ì •
3. **ìœ ì—°ì„±**: Initialize ë©”ì„œë“œë¡œ ë‹¨ê³„ë³„ ì´ˆê¸°í™” ê°€ëŠ¥
4. **í™•ì¥ì„±**: ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ë™ì‘
5. **í˜¸í™˜ì„±**: ê¸°ì¡´ íŒ¨í„´ê³¼ ì™„ë²½ í˜¸í™˜

### ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

ê¸°ì¡´ ì½”ë“œë¥¼ ìƒˆë¡œìš´ íŒ¨í„´ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” ë°©ë²•:

```fsharp
// Before (ê¸°ì¡´ ë°©ì‹)
let system = createExtensible (fun () -> 
    DsSystem(flows, works, arrows, apiDefs, apiCalls)
    |> tee (fun z ->
        flows |> iter (setParentI z)
        works |> iter (setParentI z)
        arrows |> iter (setParentI z)
        apiDefs |> iter (setParentI z)
        apiCalls |> iter (setParentI z)))

// After (ìƒˆë¡œìš´ ë°©ì‹)
let system = createExtended<DsSystem>()
system.Initialize(flows, works, arrows, apiDefs, apiCalls) |> ignore
```

---

## ğŸ”„ ë²„ì „ ì´ë ¥

- **v1.0**: ì´ˆê¸° í™•ì¥ ì‹œìŠ¤í…œ êµ¬í˜„
- **v1.1**: Factory ê¸°ë°˜ ìë™ ìƒì„± ì§€ì›
- **v1.2**: F# ëª¨ë“ˆ í•¨ìˆ˜ ì§ì ‘ í˜¸ì¶œ ì§€ì›
- **v1.3**: Complete Type Support (Runtime + JSON + ORM)
- **v1.4**: ìƒˆë¡œìš´ `createExtended<T>()` íŒ¨í„´ ë° Initialize ë©”ì„œë“œ ì¶”ê°€

ì´ í™•ì¥ ì‹œìŠ¤í…œì„ í†µí•´ DSE v2ì˜ í•µì‹¬ ê¸°ëŠ¥ì„ ì†ìƒì‹œí‚¤ì§€ ì•Šìœ¼ë©´ì„œë„ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ `createExtended<T>()` íŒ¨í„´ìœ¼ë¡œ ë”ìš± ê°„ê²°í•˜ê³  íƒ€ì… ì•ˆì „í•œ ê°ì²´ ìƒì„±ì´ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.