# EV2 ì—”í‹°í‹°ë³„ ì˜µì…˜ ì •ì˜ ì‚¬ì–‘ì„œ

## ğŸ“‹ ê°œìš”

### ì„¤ê³„ ì›ì¹™
- **ë¹„íŠ¸ 0**: `None` (í•­ìƒ 0, ê¸°ë³¸ê°’)
- **ë¹„íŠ¸ 1-3**: `Primary Mode` (3ë¹„íŠ¸ë¡œ 8ê°€ì§€ ì£¼ ëª¨ë“œ)
- **ë¹„íŠ¸ 4-63**: ë…ë¦½ í”Œë˜ê·¸ ë° ì¶”ê°€ ëª¨ë“œ ì˜ì—­
  - ë¹„íŠ¸ 4-6: `Secondary Mode` (í•„ìš”ì‹œ 3ë¹„íŠ¸ ì¶”ê°€ ëª¨ë“œ)
  - ë¹„íŠ¸ 7-9: `Tertiary Mode` (í•„ìš”ì‹œ 3ë¹„íŠ¸ ì¶”ê°€ ëª¨ë“œ)
  - ë¹„íŠ¸ 10-63: Boolean í”Œë˜ê·¸ë“¤ ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ ëª¨ë“œ

---
# EV2 ì—”í‹°í‹°ë³„ ì˜µì…˜ ì •ì˜ ì‚¬ì–‘ì„œ

## 1. Project Options

```fsharp
type ProjectMode =
    | None = 0 | Test = 1 | Debug = 2 | Reserved3-7 

type ProjectEnvironment = 
    | None = 0 | Development = 1 | Production = 2 | Reserved3-7

[<System.Flags>]
type ProjectOptions =
    | None = 0 
    | ModeMask        = 0b1110L         // ë¹„íŠ¸ 1-3
    | EnvironmentMask = 0b1110000L    // ë¹„íŠ¸ 4-6
    | ReaservedMask3  = 0b1110000000L       // ë¹„íŠ¸ 7-9
    | ReadOnly = 1L <<< 10
    | AutoSave = 1L <<< 11
    | LogEnabled = 1L <<< 12
```

## 2. System Options

```fsharp
type SystemMode =
    | None = 0
    | Simulation = 0 
    | Control = 1
    | Monitoring = 2 
    | VirtualPlant = 3
    | VirtualLogic = 4
    | Reserved5-7 = 5-7

type SystemType =
    | None = 0 | SubSystem = 1 | Reserved2-7

type SystemState =
    | None = 0 | Ready = 1 | Error = 2 | Reserved3-7

[<System.Flags>]
type SystemOptions =
    | None = 0 
    | ModeMask = 0b1110L                   // ë¹„íŠ¸ 1-3
    | TypeMask = 0b1110000L                // ë¹„íŠ¸ 4-6
    | StateMask = 0b1110000000L            // ë¹„íŠ¸ 7-9
    | PauseMonitor = 1L <<< 10
    | IdleMonitor = 1L <<< 11
    | AutoMonitor = 1L <<< 12
    | ManualMonitor = 1L <<< 13
    | DriveMonitor = 1L <<< 14
    | TestMonitor = 1L <<< 15
    | ErrorMonitor = 1L <<< 16
    | EmergencyMonitor = 1L <<< 17
    | ReadyMonitor = 1L <<< 18
    | OriginMonitor = 1L <<< 19
    | GoingMonitor = 1L <<< 20
    | Reserved21-63 = 21-63
```

## 3. Flow Options

```fsharp
type FlowMode =
    | None = 0 | Idle = 1 | Auto = 2 | Manual = 3

[<System.Flags>]
type FlowOptions =
    | None = 0 
    | ModeMask = 0b1110L                   // ë¹„íŠ¸ 1-3
    | DriveState = 1L <<< 10
    | TestState = 1L <<< 11
    | ErrorState = 1L <<< 12
    | EmergencyState = 1L <<< 13
    | ReadyState = 1L <<< 14
    | OriginState = 1L <<< 15
    | GoingState = 1L <<< 16
    | PauseState = 1L <<< 17
    | AutoMode = 1L <<< 18
    | ManualMode = 1L <<< 19
    | FlowReady = 1L <<< 20
```

## 4. Work Options
    member val IsFinished   = false      with get, set   // ì‚­ì œí›„  WorkOptions.IsFinished ì¶”ê°€

```fsharp
type WorkState =  // FSM ìƒíƒœ (ìƒí˜¸ ë°°íƒ€ì )
    | None = 0 | Ready = 1 | Going = 2 | Finish = 3 | Homing = 4

[<System.Flags>]
type WorkOptions =
    | None = 0 
    | StateMask = 0b1110L               // ë¹„íŠ¸ 1-3: RGFH
    | ReaservedMask2  = 0b1110000L          // ë¹„íŠ¸ 4-6
    | ReaservedMask3  = 0b1110000000L       // ë¹„íŠ¸ 7-9
    | IsFinished = 1L <<< 10
    | Reserved11-63 
```

## 5. Call Options

   Call member ë³„ë„ì¶”ê°€ í•„ìš”
        member val ActionHoldTimeMs = actionHoldTimeMs   with get, set
        member val SensorDelayTimeMs = sensorDelayTimeMs   with get, set

```fsharp
type CallState =  // FSM ìƒíƒœ (ìƒí˜¸ ë°°íƒ€ì )
    | None = 0 | Ready = 1 | Going = 2 | Finish = 3 | Homing = 4

type CallActionType =
    | Normal = 0 | Push = 1 | Pulse = 2 | HoldTime = 3 | Reserved4-7 

[<System.Flags>]
type CallOptions =
    | None = 0 
    | StateMask       = 0b1110L             // ë¹„íŠ¸ 1-3
    | ReaservedMask2  = 0b1110000L          // ë¹„íŠ¸ 4-6
    | ReaservedMask3  = 0b1110000000L       // ë¹„íŠ¸ 7-9
    | Disabled = 1L <<< 10
    | SkipOrigin = 1L <<< 11
    | Reserved11-63
```

## 6. ApiCall Options

   

```fsharp

[<System.Flags>]
type ApiCallOptions =
    | None = 0 
    | ReaservedMask1  = 0b1110L                    // ë¹„íŠ¸ 1-3
    | ReaservedMask2  = 0b1110000L          // ë¹„íŠ¸ 4-6
    | ReaservedMask3  = 0b1110000000L       // ë¹„íŠ¸ 7-9
    | Reserved10-63
```

## 7. ApiDef Options

```fsharp

type ApiDefMode =
    | Normal = 0 | ResetApi = 1 | ApiOffReset = 2 | Reserved3-7 


[<System.Flags>]
type ApiDefOptions =
    | ModeMask        = 0b1110L          // ë¹„íŠ¸ 1-3
    | ReaservedMask2  = 0b1110000L          // ë¹„íŠ¸ 4-6
    | ReaservedMask3  = 0b1110000000L       // ë¹„íŠ¸ 7-9
    | Reserved10-63
```

## ê³µí†µ í—¬í¼

```fsharp
module OptionsHelper =
    let hasFlag options flag = (options &&& flag) = flag
    let setFlag options flag value = 
        if value then options ||| flag else options &&& ~~~flag
    let getMode options mask =
        let shift = System.Numerics.BitOperations.TrailingZeroCount(uint64 mask)
        int ((options &&& mask) >>> shift)
    let setMode options mask mode =
        let shift = System.Numerics.BitOperations.TrailingZeroCount(uint64 mask)
        (options &&& ~~~mask) ||| (int64 mode <<< shift)
```

## ì£¼ìš” íŠ¹ì§•
- **í™•ì¥ì„±**: 64ë¹„íŠ¸ ê³µê°„ íš¨ìœ¨ì  í™œìš©
- **DB í˜¸í™˜**: ë‹¨ì¼ BIGINT ì»¬ëŸ¼ìœ¼ë¡œ ì €ì¥